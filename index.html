<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Houssem GPA - Full Streams</title>
    <style>
        :root { --blue: #002868; --red: #bf0a30; --green: #2ecc71; --orange: #f39c12; }
        body { font-family: 'Segoe UI', sans-serif; background-color: #f0f2f5; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .container { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); width: 100%; max-width: 750px; border-top: 6px solid var(--blue); margin-bottom: 15px; box-sizing: border-box; }
        
        .selection-box { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; background: #eef2f7; padding: 15px; border-radius: 10px; margin-top: 10px; }
        select { width: 100%; padding: 10px; border-radius: 6px; border: 2px solid var(--blue); font-weight: bold; }

        .amazigh-toggle { background: #fff3cd; padding: 10px; border-radius: 8px; margin: 10px 0; display: flex; align-items: center; justify-content: center; gap: 10px; border: 1px solid #ffeeba; }
        .switch { position: relative; display: inline-block; width: 40px; height: 20px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--green); }
        input:checked + .slider:before { transform: translateX(20px); }

        .table-wrapper { width: 100%; overflow-x: auto; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; }
        th, td { padding: 10px; border-bottom: 1px solid #eee; text-align: center; font-size: 0.85em; }
        th { background: #f8f9fa; color: var(--blue); }
        input[type="number"] { width: 45px; padding: 5px; border-radius: 4px; border: 1px solid #ccc; text-align: center; font-weight: bold; }

        .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 15px; }
        .btn { padding: 15px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; color: white; }
        .btn-calc { background: var(--red); grid-column: span 2; }
        .btn-save { background: var(--green); }
        .btn-restore { background: var(--orange); }
        #result-card { margin-top: 15px; padding: 20px; border-radius: 10px; text-align: center; display: none; font-weight: bold; color: white; font-size: 1.5em; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align:center; color:var(--blue);">ğŸ“Š Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h2>
    <div class="selection-box">
        <div>
            <label>Ø§Ù„Ù…Ø³ØªÙˆÙ‰:</label>
            <select id="level" onchange="updateStreams()">
                <option value="1">1 Ø«Ø§Ù†ÙˆÙŠ</option>
                <option value="2">2 Ø«Ø§Ù†ÙˆÙŠ</option>
                <option value="3">3 Ø«Ø§Ù†ÙˆÙŠ (Ø¨Ø§ÙƒØ§Ù„ÙˆØ±ÙŠØ§)</option>
            </select>
        </div>
        <div>
            <label>Ø§Ù„Ø´Ø¹Ø¨Ø©:</label>
            <select id="stream" onchange="loadSubjects()"></select>
        </div>
    </div>
    <div class="amazigh-toggle">
        <span>Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø§Ù„Ø£Ù…Ø§Ø²ÙŠØºÙŠØ©ØŸ</span>
        <label class="switch"><input type="checkbox" id="amazigh-check" onchange="loadSubjects()"><span class="slider"></span></label>
    </div>
</div>

<div class="container">
    <div class="table-wrapper">
        <table>
            <thead><tr><th>Ø§Ù„Ù…Ø§Ø¯Ø©</th><th>ØªÙ‚ÙˆÙŠÙ…</th><th>Ø§.ØªØ·Ø¨ÙŠÙ‚ÙŠØ©</th><th>ÙØ±Ø¶1</th><th>ÙØ±Ø¶2</th><th>Ø§Ø®ØªØ¨Ø§Ø±</th><th>Ù…Ø¹Ø§Ù…Ù„</th></tr></thead>
            <tbody id="m-body"></tbody>
        </table>
    </div>
    <div class="btn-group">
        <button class="btn btn-calc" onclick="calculate()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¢Ù† ğŸš€</button>
        <button class="btn btn-save" onclick="save()">Ø­ÙØ¸ âœ…</button>
        <button class="btn btn-restore" onclick="restore()">Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ğŸ”„</button>
    </div>
    <div id="result-card"></div>
</div>

<script>
    const allData = {
        "1": {
            "Ø¬Ø°Ø¹ Ù…Ø´ØªØ±Ùƒ Ø¹Ù„ÙˆÙ… ÙˆØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§": [["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",5],["ÙÙŠØ²ÙŠØ§Ø¡",4],["Ø¹Ù„ÙˆÙ… Ø·Ø¨ÙŠØ¹ÙŠØ©",4],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§",2],["Ø¥Ø¹Ù„Ø§Ù… Ø¢Ù„ÙŠ",2],["ØªØ±Ø¨ÙŠØ© ÙÙ†ÙŠØ©",1],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "Ø¬Ø°Ø¹ Ù…Ø´ØªØ±Ùƒ Ø¢Ø¯Ø§Ø¨": [["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",5],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",4],["ÙØ±Ù†Ø³ÙŠØ©",3],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",3],["Ø¹Ù„ÙˆÙ… Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",2],["ÙÙŠØ²ÙŠØ§Ø¡",2],["Ø¹Ù„ÙˆÙ… Ø·Ø¨ÙŠØ¹ÙŠØ©",2],["Ø¥Ø¹Ù„Ø§Ù… Ø¢Ù„ÙŠ",2],["ØªØ±Ø¨ÙŠØ© ÙÙ†ÙŠØ©",1],["Ø±ÙŠØ§Ø¶Ø©",1]],
        },
        "2": {
            "Ø¹Ù„ÙˆÙ… ØªØ¬Ø±ÙŠØ¨ÙŠØ©": [["Ø¹Ù„ÙˆÙ… Ø·Ø¨ÙŠØ¹ÙŠØ©",6],["ÙÙŠØ²ÙŠØ§Ø¡",5],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",5],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["ÙÙ„Ø³ÙØ©",2],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "Ø±ÙŠØ§Ø¶ÙŠØ§Øª": [["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",7],["ÙÙŠØ²ÙŠØ§Ø¡",6],["Ø¹Ù„ÙˆÙ… Ø·Ø¨ÙŠØ¹ÙŠØ©",2],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["ÙÙ„Ø³ÙØ©",2],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "ØªÙ‚Ù†ÙŠ Ø±ÙŠØ§Ø¶ÙŠ": [["ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§",7],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",6],["ÙÙŠØ²ÙŠØ§Ø¡",5],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["ÙÙ„Ø³ÙØ©",2],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "ØªØ³ÙŠÙŠØ± ÙˆØ§Ù‚ØªØµØ§Ø¯": [["ØªØ³ÙŠÙŠØ± Ù…Ø­Ø§Ø³Ø¨ÙŠ",6],["Ø§Ù‚ØªØµØ§Ø¯ ÙˆÙ…Ù†Ø§Ø¬Ù…Ù†Øª",5],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",5],["Ù‚Ø§Ù†ÙˆÙ†",2],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",4],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "Ø¢Ø¯Ø§Ø¨ ÙˆÙÙ„Ø³ÙØ©": [["ÙÙ„Ø³ÙØ©",5],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",5],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",4],["Ù„ØºØ© ÙØ±Ù†Ø³ÙŠØ©",3],["Ù„ØºØ© Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",3],["Ø¹Ù„ÙˆÙ… Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "Ù„ØºØ§Øª Ø£Ø¬Ù†Ø¨ÙŠØ©": [["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",4],["Ù„ØºØ© ÙØ±Ù†Ø³ÙŠØ©",4],["Ù„ØºØ© Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",4],["Ù„ØºØ© Ø£Ø¬Ù†Ø¨ÙŠØ© 3",4],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["ÙÙ„Ø³ÙØ©",2],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",2],["Ø±ÙŠØ§Ø¶Ø©",1]]
        },
        "3": {
            "Ø¹Ù„ÙˆÙ… ØªØ¬Ø±ÙŠØ¨ÙŠØ©": [["Ø¹Ù„ÙˆÙ… Ø·Ø¨ÙŠØ¹ÙŠØ©",6],["ÙÙŠØ²ÙŠØ§Ø¡",5],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",5],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["ÙÙ„Ø³ÙØ©",2],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "Ø±ÙŠØ§Ø¶ÙŠØ§Øª": [["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",7],["ÙÙŠØ²ÙŠØ§Ø¡",6],["Ø¹Ù„ÙˆÙ… Ø·Ø¨ÙŠØ¹ÙŠØ©",2],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["ÙÙ„Ø³ÙØ©",2],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "ØªÙ‚Ù†ÙŠ Ø±ÙŠØ§Ø¶ÙŠ": [["ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§",7],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",6],["ÙÙŠØ²ÙŠØ§Ø¡",6],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["ÙÙ„Ø³ÙØ©",2],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "ØªØ³ÙŠÙŠØ± ÙˆØ§Ù‚ØªØµØ§Ø¯": [["ØªØ³ÙŠÙŠØ± Ù…Ø­Ø§Ø³Ø¨ÙŠ",6],["Ø§Ù‚ØªØµØ§Ø¯ ÙˆÙ…Ù†Ø§Ø¬Ù…Ù†Øª",5],["Ù‚Ø§Ù†ÙˆÙ†",2],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",5],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",3],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",4],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["ÙØ±Ù†Ø³ÙŠØ©",2],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "Ø¢Ø¯Ø§Ø¨ ÙˆÙÙ„Ø³ÙØ©": [["ÙÙ„Ø³ÙØ©",6],["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",6],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",4],["ÙØ±Ù†Ø³ÙŠØ©",3],["Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",3],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",2],["Ø±ÙŠØ§Ø¶Ø©",1]],
            "Ù„ØºØ§Øª Ø£Ø¬Ù†Ø¨ÙŠØ©": [["Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©",5],["Ù„ØºØ© ÙØ±Ù†Ø³ÙŠØ©",4],["Ù„ØºØ© Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠØ©",4],["Ù„ØºØ© Ø£Ø¬Ù†Ø¨ÙŠØ© 3",4],["ÙÙ„Ø³ÙØ©",2],["Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª",2],["Ø¥Ø³Ù„Ø§Ù…ÙŠØ©",2],["Ø±ÙŠØ§Ø¶ÙŠØ§Øª",2],["Ø±ÙŠØ§Ø¶Ø©",1]]
        }
    };

    function updateStreams() {
        const lvl = document.getElementById("level").value;
        const streamSelect = document.getElementById("stream");
        streamSelect.innerHTML = "";
        for (let s in allData[lvl]) {
            let opt = document.createElement("option"); opt.value = s; opt.innerText = s;
            streamSelect.appendChild(opt);
        }
        loadSubjects();
    }

    function loadSubjects() {
        const lvl = document.getElementById("level").value;
        const stm = document.getElementById("stream").value;
        let subjects = [...allData[lvl][stm]];
        if (document.getElementById("amazigh-check").checked) { subjects.push(["Ù„ØºØ© Ø£Ù…Ø§Ø²ÙŠØºÙŠØ©", 2]); }
        let html = "";
        subjects.forEach(s => {
            html += `<tr data-coef="${s[1]}"><td>${s[0]}</td>
                <td><input type="number" oninput="v(this)"></td><td><input type="number" oninput="v(this)"></td>
                <td><input type="number" oninput="v(this)"></td><td><input type="number" oninput="v(this)"></td>
                <td><input type="number" oninput="v(this)"></td><td><b>${s[1]}</b></td></tr>`;
        });
        document.getElementById("m-body").innerHTML = html;
    }

    function v(el) { if(el.value>20) el.value=20; if(el.value<0) el.value=0; }

    function calculate() {
        let tP = 0, tC = 0;
        document.querySelectorAll("#m-body tr").forEach(row => {
            let ins = row.querySelectorAll("input"), c = parseFloat(row.dataset.coef), sC = 0, count = 0;
            for(let i=0; i<4; i++) { let v = parseFloat(ins[i].value); if(!isNaN(v)) { sC += v; count++; } }
            let avg = ((count>0 ? sC/count : 0) + (parseFloat(ins[4].value)||0)*2)/3;
            tP += (avg * c); tC += c;
        });
        let res = document.getElementById("result-card");
        res.style.display = "block";
        let final = tP/tC;
        res.style.background = final>=10 ? "#2ecc71" : "#e74c3c";
        res.innerText = isNaN(final) ? "Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Ù‚Ø§Ø·" : "Ø§Ù„Ù…Ø¹Ø¯Ù„: " + final.toFixed(2);
    }

    function save() {
        let s = { lvl: document.getElementById("level").value, stm: document.getElementById("stream").value, amz: document.getElementById("amazigh-check").checked, scores: [] };
        document.querySelectorAll("#m-body input").forEach(i => s.scores.push(i.value));
        localStorage.setItem("HOUSSEM_FULL_SEC_V3", JSON.stringify(s)); alert("ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ âœ…");
    }

    function restore() {
        let d = JSON.parse(localStorage.getItem("HOUSSEM_FULL_SEC_V3"));
        if(!d) return alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­ÙÙˆØ¸Ø§Øª");
        document.getElementById("level").value = d.lvl; updateStreams();
        document.getElementById("stream").value = d.stm; document.getElementById("amazigh-check").checked = d.amz;
        loadSubjects();
        setTimeout(() => { document.querySelectorAll("#m-body input").forEach((i, idx) => i.value = d.scores[idx]); }, 100);
    }

    updateStreams();
</script>
</body>
</html>
